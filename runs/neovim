#!/usr/bin/env bash
set -e

echo "Install neovim"
#https://github.com/neovim/neovim

neovim_dir=$HOME/code/neovim
neovim_version=v0.11.3

# Check for required tools
command -v git || { echo "Installing git..."; sudo apt update && sudo apt install -y git; }
command -v gcc || { echo "Installing build tools..."; sudo apt update && sudo apt install -y gcc make cmake; }
command -v python3 || { echo "Installing python3..."; sudo apt update && sudo apt install -y python3 python3-venv python3-pip; }
command -v npm || { echo "Installing nodejs and npm..."; sudo apt update && sudo apt install -y nodejs npm; }

git clone -b $neovim_version --depth 1 https://github.com/neovim/neovim.git $neovim_dir
sudo apt install -y gettext lua5.1 liblua5.1-0-dev \
                    ripgrep unzip xclip fd-find 

ln -s $(which fdfind) ~/.local/bin/fd

cd $neovim_dir
make CMAKE_BUILD_TYPE=RelWithDebInfo
sudo make install
